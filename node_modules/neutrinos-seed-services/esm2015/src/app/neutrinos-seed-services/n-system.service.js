import * as platform from 'platform';
// @dynamic
export class NSystemService {
    static getInstance() {
        if (!this.instance) {
            this.instance = new NSystemService();
        }
        return this.instance;
    }
    constructor() {
        this._deviceType = this.checkDevice();
    }
    /**
     * Seter and getter for the environments
     */
    // set environments(properties) {
    //   console.log(properties);
    //   NSystemService.envProperties = properties;
    //   this.properties = this.getVal('properties');
    // }
    // get environments() {
    //   return NSystemService.envProperties;
    // }
    /**
     * Returna 'mobile' or 'browser' based on the platform
     */
    checkDevice() {
        if (window['device'] && (window['device']['platform'] != 'browser' || window['device']['platform'] != 'Browser')) {
            return 'mobile';
        }
        else if (window['device'] && (window['device']['platform'] == 'browser' || window['device']['platform'] == 'Browser')) {
            return 'cordova_browser';
        }
        else {
            return 'browser';
        }
    }
    get deviceType() {
        return this._deviceType;
    }
    getVal(key) {
        if (!NSystemService.envProperties) {
            NSystemService.envProperties = window['neutrinos']['environments'];
            this.properties = NSystemService.envProperties.properties;
        }
        if (key == 'properties') {
            if (NSystemService.envProperties) {
                return NSystemService.envProperties.properties;
            }
            else {
                return undefined;
            }
        }
        else {
            if (NSystemService.envProperties && NSystemService.envProperties.properties) {
                return NSystemService.envProperties.properties[key];
            }
            else {
                return undefined;
            }
        }
    }
    isAndroid() {
        if (window['device'] && window['device']['platform'] == 'Android') {
            return true;
        }
        else {
            return false;
        }
    }
    isIOS() {
        if (window['device'] && window['device']['platform'] == 'iOS') {
            return true;
        }
        else {
            return false;
        }
    }
    getAndroidVersion() {
        if (this.isAndroid()) {
            return window['device']['version'];
        }
        else {
            return '';
        }
    }
    getAuthUrl() {
        // this.properties = this.getVal('properties');
        return this.properties.baseUrl + this.properties.tenantName + '/auth/';
    }
    getTenantUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/';
    }
    getAppUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/proxy/' + this.properties.appName + '/';
    }
    getProxyUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/proxy/';
    }
    getDataModelUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/datamodel/' + this.properties.appDataSource + '/' + this.properties.appName + '/';
    }
    getFileIOUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/fileio/' +
            this.properties.appDataSource + '/' + this.properties.appName + '/';
    }
    getPlatformDetails(type) {
        const pDetails = {
            platform: platform.os.family,
            platformVersion: platform.os.version,
        };
        if (type === 'browser') {
            return Object.assign(pDetails, {
                type: 'browser',
                browser: platform.name,
                browserVersion: platform.version,
            });
        }
        else if (type === 'mobile' || type === 'cordova_browser') {
            return Object.assign(pDetails, {
                type: 'mobile',
                model: window['device'].model,
                manufacturer: window['device'].manufacturer,
                isVirtual: window['device'].isVirtual
            });
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibi1zeXN0ZW0uc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25ldXRyaW5vcy1zZWVkLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsic3JjL2FwcC9uZXV0cmlub3Mtc2VlZC1zZXJ2aWNlcy9uLXN5c3RlbS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUlBLE9BQU8sS0FBSyxRQUFRLE1BQU0sVUFBVSxDQUFDO0FBRXJDLFdBQVc7QUFDWCxNQUFNLE9BQU8sY0FBYztJQVF6QixNQUFNLENBQUMsV0FBVztRQUNoQixJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNsQixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksY0FBYyxFQUFFLENBQUM7U0FDdEM7UUFDRCxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDdkIsQ0FBQztJQUVEO1FBQ0UsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDeEMsQ0FBQztJQUVEOztPQUVHO0lBRUgsaUNBQWlDO0lBQ2pDLDZCQUE2QjtJQUM3QiwrQ0FBK0M7SUFDL0MsaURBQWlEO0lBQ2pELElBQUk7SUFFSix1QkFBdUI7SUFDdkIseUNBQXlDO0lBQ3pDLElBQUk7SUFFSjs7T0FFRztJQUNILFdBQVc7UUFDVCxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBSSxTQUFTLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLFNBQVMsQ0FBQyxFQUFFO1lBQ2hILE9BQU8sUUFBUSxDQUFDO1NBQ2pCO2FBQU0sSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksU0FBUyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBSSxTQUFTLENBQUMs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SSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEdBQUcsVUFBVTtZQUN0RSxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDO0lBQ3hFLENBQUM7SUFFTSxrQkFBa0IsQ0FBQyxJQUFJO1FBQzVCLE1BQU0sUUFBUSxHQUFHO1lBQ2YsUUFBUSxFQUFFLFFBQVEsQ0FBQyxFQUFFLENBQUMsTUFBTTtZQUM1QixlQUFlLEVBQUUsUUFBUSxDQUFDLEVBQUUsQ0FBQyxPQUFPO1NBQ3JDLENBQUM7UUFDRixJQUFJLElBQUksS0FBSyxTQUFTLEVBQUU7WUFDdEIsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRTtnQkFDN0IsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsT0FBTyxFQUFFLFFBQVEsQ0FBQyxJQUFJO2dCQUN0QixjQUFjLEVBQUUsUUFBUSxDQUFDLE9BQU87YUFDakMsQ0FBQyxDQUFDO1NBQ0o7YUFBTSxJQUFJLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxLQUFLLGlCQUFpQixFQUFFO1lBQzFELE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUU7Z0JBQzdCLElBQUksRUFBRSxRQUFRO2dCQUNkLEtBQUssRUFBRSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsS0FBSztnQkFDN0IsWUFBWSxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxZQUFZO2dCQUMzQyxTQUFTLEVBQUUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFNBQVM7YUFDdEMsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBlbnZpcm9ubWVudCB9IGZyb20gJy4uLy4uL2Vudmlyb25tZW50cy9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBOVXRpbGl0eSB9IGZyb20gJy4vbi11dGlsLnNlcnZpY2UnO1xuaW1wb3J0IHsgTkxvY2FsU3RvcmFnZVNlcnZpY2UgfSBmcm9tICcuL24tbG9jYWxTdG9yYWdlLnNlcnZpY2UnO1xuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0ICogYXMgcGxhdGZvcm0gZnJvbSAncGxhdGZvcm0nO1xuXG4vLyBAZHluYW1pY1xuZXhwb3J0IGNsYXNzIE5TeXN0ZW1TZXJ2aWNlIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IE5TeXN0ZW1TZXJ2aWNlO1xuXG4gIHByaXZhdGUgX2RldmljZVR5cGU6IHN0cmluZztcbiAgLy8gcHJpdmF0ZSBfZGV2aWNlVVVJRDtcbiAgdXVpZDtcbiAgcHJvcGVydGllcztcbiAgc3RhdGljIGVudlByb3BlcnRpZXM7XG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcbiAgICBpZiAoIXRoaXMuaW5zdGFuY2UpIHtcbiAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgTlN5c3RlbVNlcnZpY2UoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG4gIH1cblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuX2RldmljZVR5cGUgPSB0aGlzLmNoZWNrRGV2aWNlKCk7XG4gIH1cblxuICAvKipcbiAgICogU2V0ZXIgYW5kIGdldHRlciBmb3IgdGhlIGVudmlyb25tZW50c1xuICAgKi9cblxuICAvLyBzZXQgZW52aXJvbm1lbnRzKHByb3BlcnRpZXMpIHtcbiAgLy8gICBjb25zb2xlLmxvZyhwcm9wZXJ0aWVzKTtcbiAgLy8gICBOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzID0gcHJvcGVydGllcztcbiAgLy8gICB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLmdldFZhbCgncHJvcGVydGllcycpO1xuICAvLyB9XG5cbiAgLy8gZ2V0IGVudmlyb25tZW50cygpIHtcbiAgLy8gICByZXR1cm4gTlN5c3RlbVNlcnZpY2UuZW52UHJvcGVydGllcztcbiAgLy8gfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5hICdtb2JpbGUnIG9yICdicm93c2VyJyBiYXNlZCBvbiB0aGUgcGxhdGZvcm1cbiAgICovXG4gIGNoZWNrRGV2aWNlKCk6IHN0cmluZyB7XG4gICAgaWYgKHdpbmRvd1snZGV2aWNlJ10gJiYgKHdpbmRvd1snZGV2aWNlJ11bJ3BsYXRmb3JtJ10gIT0gJ2Jyb3dzZXInIHx8IHdpbmRvd1snZGV2aWNlJ11bJ3BsYXRmb3JtJ10gIT0gJ0Jyb3dzZXInKSkge1xuICAgICAgcmV0dXJuICdtb2JpbGUnO1xuICAgIH0gZWxzZSBpZiAod2luZG93WydkZXZpY2UnXSAmJiAod2luZG93WydkZXZpY2UnXVsncGxhdGZvcm0nXSA9PSAnYnJvd3NlcicgfHwgd2luZG93WydkZXZpY2UnXVsncGxhdGZvcm0nXSA9PSAnQnJvd3NlcicpKSB7XG4gICAgICByZXR1cm4gJ2NvcmRvdmFfYnJvd3Nlcic7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnYnJvd3Nlcic7XG4gICAgfVxuICB9XG5cblxuICBwdWJsaWMgZ2V0IGRldmljZVR5cGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2RldmljZVR5cGU7XG4gIH1cblxuXG5cbiAgcHVibGljIGdldFZhbChrZXkpIHtcbiAgICBpZiAoIU5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMpIHtcbiAgICAgIE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMgPSB3aW5kb3dbJ25ldXRyaW5vcyddWydlbnZpcm9ubWVudHMnXTtcbiAgICAgIHRoaXMucHJvcGVydGllcyA9IE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMucHJvcGVydGllcztcbiAgICB9XG5cbiAgICBpZiAoa2V5ID09ICdwcm9wZXJ0aWVzJykge1xuICAgICAgaWYgKE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMpIHtcbiAgICAgICAgcmV0dXJuIE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMucHJvcGVydGllcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzICYmIE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMucHJvcGVydGllcykge1xuICAgICAgICByZXR1cm4gTlN5c3RlbVNlcnZpY2UuZW52UHJvcGVydGllcy5wcm9wZXJ0aWVzW2tleV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgfVxuXG4gIH1cblxuICBwdWJsaWMgaXNBbmRyb2lkKCkge1xuICAgIGlmICh3aW5kb3dbJ2RldmljZSddICYmIHdpbmRvd1snZGV2aWNlJ11bJ3BsYXRmb3JtJ10gPT0gJ0FuZHJvaWQnKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBpc0lPUygpIHtcbiAgICBpZiAod2luZG93WydkZXZpY2UnXSAmJiB3aW5kb3dbJ2RldmljZSddWydwbGF0Zm9ybSddID09ICdpT1MnKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBnZXRBbmRyb2lkVmVyc2lvbigpIHtcbiAgICBpZiAodGhpcy5pc0FuZHJvaWQoKSkge1xuICAgICAgcmV0dXJuIHdpbmRvd1snZGV2aWNlJ11bJ3ZlcnNpb24nXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBnZXRBdXRoVXJsKCkge1xuICAgIC8vIHRoaXMucHJvcGVydGllcyA9IHRoaXMuZ2V0VmFsKCdwcm9wZXJ0aWVzJyk7XG4gICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5iYXNlVXJsICsgdGhpcy5wcm9wZXJ0aWVzLnRlbmFudE5hbWUgKyAnL2F1dGgvJztcbiAgfVxuICBwdWJsaWMgZ2V0VGVuYW50VXJsKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuYmFzZVVybCArIHRoaXMucHJvcGVydGllcy50ZW5hbnROYW1lICsgJy8nO1xuICB9XG5cbiAgcHVibGljIGdldEFwcFVybCgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmJhc2VVcmwgKyB0aGlzLnByb3BlcnRpZXMudGVuYW50TmFtZSArICcvcHJveHkvJyArIHRoaXMucHJvcGVydGllcy5hcHBOYW1lICsgJy8nO1xuICB9XG5cbiAgcHVibGljIGdldFByb3h5VXJsKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuYmFzZVVybCArIHRoaXMucHJvcGVydGllcy50ZW5hbnROYW1lICsgJy9wcm94eS8nO1xuICB9XG5cbiAgcHVibGljIGdldERhdGFNb2RlbFVybCgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmJhc2VVcmwgKyB0aGlzLnByb3BlcnRpZXMudGVuYW50TmFtZSArICcvZGF0YW1vZGVsLycgKyB0aGlzLnByb3BlcnRpZXMuYXBwRGF0YVNvdXJjZSArICcvJyArIHRoaXMucHJvcGVydGllcy5hcHBOYW1lICsgJy8nO1xuICB9XG5cbiAgcHVibGljIGdldEZpbGVJT1VybCgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmJhc2VVcmwgKyB0aGlzLnByb3BlcnRpZXMudGVuYW50TmFtZSArICcvZmlsZWlvLycgK1xuICAgICAgdGhpcy5wcm9wZXJ0aWVzLmFwcERhdGFTb3VyY2UgKyAnLycgKyB0aGlzLnByb3BlcnRpZXMuYXBwTmFtZSArICcvJztcbiAgfVxuXG4gIHB1YmxpYyBnZXRQbGF0Zm9ybURldGFpbHModHlwZSkge1xuICAgIGNvbnN0IHBEZXRhaWxzID0ge1xuICAgICAgcGxhdGZvcm06IHBsYXRmb3JtLm9zLmZhbWlseSxcbiAgICAgIHBsYXRmb3JtVmVyc2lvbjogcGxhdGZvcm0ub3MudmVyc2lvbixcbiAgICB9O1xuICAgIGlmICh0eXBlID09PSAnYnJvd3NlcicpIHtcbiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHBEZXRhaWxzLCB7XG4gICAgICAgIHR5cGU6ICdicm93c2VyJyxcbiAgICAgICAgYnJvd3NlcjogcGxhdGZvcm0ubmFtZSxcbiAgICAgICAgYnJvd3NlclZlcnNpb246IHBsYXRmb3JtLnZlcnNpb24sXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdtb2JpbGUnIHx8IHR5cGUgPT09ICdjb3Jkb3ZhX2Jyb3dzZXInKSB7XG4gICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwRGV0YWlscywge1xuICAgICAgICB0eXBlOiAnbW9iaWxlJyxcbiAgICAgICAgbW9kZWw6IHdpbmRvd1snZGV2aWNlJ10ubW9kZWwsXG4gICAgICAgIG1hbnVmYWN0dXJlcjogd2luZG93WydkZXZpY2UnXS5tYW51ZmFjdHVyZXIsXG4gICAgICAgIGlzVmlydHVhbDogd2luZG93WydkZXZpY2UnXS5pc1ZpcnR1YWxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuIl19