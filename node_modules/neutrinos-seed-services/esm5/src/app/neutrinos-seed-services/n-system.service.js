import * as platform from 'platform';
// @dynamic
var NSystemService = /** @class */ (function () {
    function NSystemService() {
        this._deviceType = this.checkDevice();
    }
    NSystemService.getInstance = function () {
        if (!this.instance) {
            this.instance = new NSystemService();
        }
        return this.instance;
    };
    /**
     * Seter and getter for the environments
     */
    // set environments(properties) {
    //   console.log(properties);
    //   NSystemService.envProperties = properties;
    //   this.properties = this.getVal('properties');
    // }
    // get environments() {
    //   return NSystemService.envProperties;
    // }
    /**
     * Returna 'mobile' or 'browser' based on the platform
     */
    NSystemService.prototype.checkDevice = function () {
        if (window['device'] && (window['device']['platform'] != 'browser' || window['device']['platform'] != 'Browser')) {
            return 'mobile';
        }
        else if (window['device'] && (window['device']['platform'] == 'browser' || window['device']['platform'] == 'Browser')) {
            return 'cordova_browser';
        }
        else {
            return 'browser';
        }
    };
    Object.defineProperty(NSystemService.prototype, "deviceType", {
        get: function () {
            return this._deviceType;
        },
        enumerable: true,
        configurable: true
    });
    NSystemService.prototype.getVal = function (key) {
        if (!NSystemService.envProperties) {
            NSystemService.envProperties = window['neutrinos']['environments'];
            this.properties = NSystemService.envProperties.properties;
        }
        if (key == 'properties') {
            if (NSystemService.envProperties) {
                return NSystemService.envProperties.properties;
            }
            else {
                return undefined;
            }
        }
        else {
            if (NSystemService.envProperties && NSystemService.envProperties.properties) {
                return NSystemService.envProperties.properties[key];
            }
            else {
                return undefined;
            }
        }
    };
    NSystemService.prototype.isAndroid = function () {
        if (window['device'] && window['device']['platform'] == 'Android') {
            return true;
        }
        else {
            return false;
        }
    };
    NSystemService.prototype.isIOS = function () {
        if (window['device'] && window['device']['platform'] == 'iOS') {
            return true;
        }
        else {
            return false;
        }
    };
    NSystemService.prototype.getAndroidVersion = function () {
        if (this.isAndroid()) {
            return window['device']['version'];
        }
        else {
            return '';
        }
    };
    NSystemService.prototype.getAuthUrl = function () {
        // this.properties = this.getVal('properties');
        return this.properties.baseUrl + this.properties.tenantName + '/auth/';
    };
    NSystemService.prototype.getTenantUrl = function () {
        return this.properties.baseUrl + this.properties.tenantName + '/';
    };
    NSystemService.prototype.getAppUrl = function () {
        return this.properties.baseUrl + this.properties.tenantName + '/proxy/' + this.properties.appName + '/';
    };
    NSystemService.prototype.getProxyUrl = function () {
        return this.properties.baseUrl + this.properties.tenantName + '/proxy/';
    };
    NSystemService.prototype.getDataModelUrl = function () {
        return this.properties.baseUrl + this.properties.tenantName + '/datamodel/' + this.properties.appDataSource + '/' + this.properties.appName + '/';
    };
    NSystemService.prototype.getFileIOUrl = function () {
        return this.properties.baseUrl + this.properties.tenantName + '/fileio/' +
            this.properties.appDataSource + '/' + this.properties.appName + '/';
    };
    NSystemService.prototype.getPlatformDetails = function (type) {
        var pDetails = {
            platform: platform.os.family,
            platformVersion: platform.os.version,
        };
        if (type === 'browser') {
            return Object.assign(pDetails, {
                type: 'browser',
                browser: platform.name,
                browserVersion: platform.version,
            });
        }
        else if (type === 'mobile' || type === 'cordova_browser') {
            return Object.assign(pDetails, {
                type: 'mobile',
                model: window['device'].model,
                manufacturer: window['device'].manufacturer,
                isVirtual: window['device'].isVirtual
            });
        }
    };
    return NSystemService;
}());
export { NSystemService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibi1zeXN0ZW0uc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25ldXRyaW5vcy1zZWVkLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsic3JjL2FwcC9uZXV0cmlub3Mtc2VlZC1zZXJ2aWNlcy9uLXN5c3RlbS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUlBLE9BQU8sS0FBSyxRQUFRLE1BQU0sVUFBVSxDQUFDO0FBRXJDLFdBQVc7QUFDWDtJQWVFO1FBQ0UsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDeEMsQ0FBQztJQVRNLDBCQUFXLEdBQWxCO1FBQ0UsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDbEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLGNBQWMsRUFBRSxDQUFDO1NBQ3RDO1FBQ0QsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDO0lBQ3ZCLENBQUM7SUFNRDs7T0FFRztJQUVILGlDQUFpQztJQUNqQyw2QkFBNkI7SUFDN0IsK0NBQStDO0lBQy9DLGlEQUFpRDtJQUNqRCxJQUFJO0lBRUosdUJBQXVCO0lBQ3ZCLHlDQUF5QztJQUN6QyxJQUFJO0lBRUo7O09BRUc7SUFDSCxvQ0FBVyxHQUFYO1FBQ0UsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksU0FBUyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBSSxTQUFTLENBQUMsRUFBRTtZQUNoSCxPQUFPLFFBQVEsQ0FBQztTQUNqQjthQUFNLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLFNBQVMsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksU0FBUyxDQUFDLEVBQUU7WUFDdkgsT0FBTyxpQkFBaUIsQ0FBQztTQUMxQjthQUFNO1lBQ0wsT0FBTyxTQUFTLENBQUM7U0FDbEI7SUFDSCxDQUFDO0lBR0Qsc0JBQVcsc0NBQVU7YUFBckI7WUFDRSxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDMUIsQ0FBQzs7O09BQUE7SUFJTSwrQkFBTSxHQUFiLFVBQWMsR0FBRztRQUNmLElBQUksQ0FBQyxjQUFjLENBQUMsYUFBYSxFQUFFO1lBQ2pDLGNBQWMsQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQ25FLElBQUksQ0FBQyxVQUFVLEdBQUcsY0FBYyxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUM7U0FDM0Q7UUFFRCxJQUFJLEdBQUcsSUFBSSxZQUFZLEVBQUU7WUFDdkIsSUFBSSxjQUFjLENBQUMsYUFBYSxFQUFFO2dCQUNoQyxPQUFPLGNBQWMsQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDO2FBQ2hEO2lCQUFNO2dCQUNMLE9BQU8sU0FBUyxDQUFDO2FBQ2xCO1NBQ0Y7YUFBTTtZQUNMLElBQUksY0FBYyxDQUFDLGFBQWEsSUFBSSxjQUFjLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRTtnQkFDM0UsT0FBTyxjQUFjLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUNyRDtpQkFBTTtnQkFDTCxPQUFPLFNBQVMsQ0FBQzthQUNsQjtTQUVGO0lBRUgsQ0FBQztJQUVNLGtDQUFTLEdBQWhCO1FBQ0UsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLFNBQVMsRUFBRTtZQUNqRSxPQUFPLElBQUksQ0FBQztTQUNiO2FBQU07WUFDTCxPQUFPLEtBQUssQ0FBQztTQUNkO0lBQ0gsQ0FBQztJQUVNLDhCQUFLLEdBQVo7UUFDRSxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksS0FBSyxFQUFFO1lBQzdELE9BQU8sSUFBSSxDQUFDO1NBQ2I7YUFBTTtZQUNMLE9BQU8sS0FBSyxDQUFDO1NBQ2Q7SUFDSCxDQUFDO0lBRU0sMENBQWlCLEdBQXhCO1FBQ0UsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFLEVBQUU7WUFDcEIsT0FBTyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDcEM7YUFBTTtZQUNMLE9BQU8sRUFBRSxDQUFDO1NBQ1g7SUFDSCxDQUFDO0lBRU0sbUNBQVUsR0FBakI7UUFDRSwrQ0FBK0M7UUFDL0MsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsR0FBRyxRQUFRLENBQUM7SUFDekUsQ0FBQztJQUNNLHFDQUFZLEdBQW5CO1FBQ0UsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUM7SUFDcEUsQ0FBQztJQUVNLGtDQUFTLEdBQWhCO1FBQ0UsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsR0FBRyxTQUFTLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDO0lBQzFHLENBQUM7SUFFTSxvQ0FBVyxHQUFsQjtRQUNFLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEdBQUcsU0FBUyxDQUFDO0lBQzFFLENBQUM7SUFFTSx3Q0FBZSxHQUF0QjtRQUNFLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEdBQUcsYUFBYSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUM7SUFDcEosQ0FBQztJQUVNLHFDQUFZLEdBQW5CO1FBQ0UsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsR0FBRyxVQUFVO1lBQ3RFLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUM7SUFDeEUsQ0FBQztJQUVNLDJDQUFrQixHQUF6QixVQUEwQixJQUFJO1FBQzVCLElBQU0sUUFBUSxHQUFHO1lBQ2YsUUFBUSxFQUFFLFFBQVEsQ0FBQyxFQUFFLENBQUMsTUFBTTtZQUM1QixlQUFlLEVBQUUsUUFBUSxDQUFDLEVBQUUsQ0FBQyxPQUFPO1NBQ3JDLENBQUM7UUFDRixJQUFJLElBQUksS0FBSyxTQUFTLEVBQUU7WUFDdEIsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRTtnQkFDN0IsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsT0FBTyxFQUFFLFFBQVEsQ0FBQyxJQUFJO2dCQUN0QixjQUFjLEVBQUUsUUFBUSxDQUFDLE9BQU87YUFDakMsQ0FBQyxDQUFDO1NBQ0o7YUFBTSxJQUFJLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxLQUFLLGlCQUFpQixFQUFFO1lBQzFELE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUU7Z0JBQzdCLElBQUksRUFBRSxRQUFRO2dCQUNkLEtBQUssRUFBRSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsS0FBSztnQkFDN0IsWUFBWSxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxZQUFZO2dCQUMzQyxTQUFTLEVBQUUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFNBQVM7YUFDdEMsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDO0lBQ0gscUJBQUM7QUFBRCxDQUFDLEFBakpELElBaUpDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tICcuLi8uLi9lbnZpcm9ubWVudHMvZW52aXJvbm1lbnQnO1xuaW1wb3J0IHsgTlV0aWxpdHkgfSBmcm9tICcuL24tdXRpbC5zZXJ2aWNlJztcbmltcG9ydCB7IE5Mb2NhbFN0b3JhZ2VTZXJ2aWNlIH0gZnJvbSAnLi9uLWxvY2FsU3RvcmFnZS5zZXJ2aWNlJztcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCAqIGFzIHBsYXRmb3JtIGZyb20gJ3BsYXRmb3JtJztcblxuLy8gQGR5bmFtaWNcbmV4cG9ydCBjbGFzcyBOU3lzdGVtU2VydmljZSB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBOU3lzdGVtU2VydmljZTtcblxuICBwcml2YXRlIF9kZXZpY2VUeXBlOiBzdHJpbmc7XG4gIC8vIHByaXZhdGUgX2RldmljZVVVSUQ7XG4gIHV1aWQ7XG4gIHByb3BlcnRpZXM7XG4gIHN0YXRpYyBlbnZQcm9wZXJ0aWVzO1xuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKSB7XG4gICAgaWYgKCF0aGlzLmluc3RhbmNlKSB7XG4gICAgICB0aGlzLmluc3RhbmNlID0gbmV3IE5TeXN0ZW1TZXJ2aWNlKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xuICB9XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9kZXZpY2VUeXBlID0gdGhpcy5jaGVja0RldmljZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldGVyIGFuZCBnZXR0ZXIgZm9yIHRoZSBlbnZpcm9ubWVudHNcbiAgICovXG5cbiAgLy8gc2V0IGVudmlyb25tZW50cyhwcm9wZXJ0aWVzKSB7XG4gIC8vICAgY29uc29sZS5sb2cocHJvcGVydGllcyk7XG4gIC8vICAgTlN5c3RlbVNlcnZpY2UuZW52UHJvcGVydGllcyA9IHByb3BlcnRpZXM7XG4gIC8vICAgdGhpcy5wcm9wZXJ0aWVzID0gdGhpcy5nZXRWYWwoJ3Byb3BlcnRpZXMnKTtcbiAgLy8gfVxuXG4gIC8vIGdldCBlbnZpcm9ubWVudHMoKSB7XG4gIC8vICAgcmV0dXJuIE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXM7XG4gIC8vIH1cblxuICAvKipcbiAgICogUmV0dXJuYSAnbW9iaWxlJyBvciAnYnJvd3NlcicgYmFzZWQgb24gdGhlIHBsYXRmb3JtXG4gICAqL1xuICBjaGVja0RldmljZSgpOiBzdHJpbmcge1xuICAgIGlmICh3aW5kb3dbJ2RldmljZSddICYmICh3aW5kb3dbJ2RldmljZSddWydwbGF0Zm9ybSddICE9ICdicm93c2VyJyB8fCB3aW5kb3dbJ2RldmljZSddWydwbGF0Zm9ybSddICE9ICdCcm93c2VyJykpIHtcbiAgICAgIHJldHVybiAnbW9iaWxlJztcbiAgICB9IGVsc2UgaWYgKHdpbmRvd1snZGV2aWNlJ10gJiYgKHdpbmRvd1snZGV2aWNlJ11bJ3BsYXRmb3JtJ10gPT0gJ2Jyb3dzZXInIHx8IHdpbmRvd1snZGV2aWNlJ11bJ3BsYXRmb3JtJ10gPT0gJ0Jyb3dzZXInKSkge1xuICAgICAgcmV0dXJuICdjb3Jkb3ZhX2Jyb3dzZXInO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJ2Jyb3dzZXInO1xuICAgIH1cbiAgfVxuXG5cbiAgcHVibGljIGdldCBkZXZpY2VUeXBlKCkge1xuICAgIHJldHVybiB0aGlzLl9kZXZpY2VUeXBlO1xuICB9XG5cblxuXG4gIHB1YmxpYyBnZXRWYWwoa2V5KSB7XG4gICAgaWYgKCFOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzKSB7XG4gICAgICBOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzID0gd2luZG93WyduZXV0cmlub3MnXVsnZW52aXJvbm1lbnRzJ107XG4gICAgICB0aGlzLnByb3BlcnRpZXMgPSBOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzLnByb3BlcnRpZXM7XG4gICAgfVxuXG4gICAgaWYgKGtleSA9PSAncHJvcGVydGllcycpIHtcbiAgICAgIGlmIChOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzKSB7XG4gICAgICAgIHJldHVybiBOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzLnByb3BlcnRpZXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoTlN5c3RlbVNlcnZpY2UuZW52UHJvcGVydGllcyAmJiBOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzLnByb3BlcnRpZXMpIHtcbiAgICAgICAgcmV0dXJuIE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMucHJvcGVydGllc1trZXldO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgIH1cblxuICB9XG5cbiAgcHVibGljIGlzQW5kcm9pZCgpIHtcbiAgICBpZiAod2luZG93WydkZXZpY2UnXSAmJiB3aW5kb3dbJ2RldmljZSddWydwbGF0Zm9ybSddID09ICdBbmRyb2lkJykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgaXNJT1MoKSB7XG4gICAgaWYgKHdpbmRvd1snZGV2aWNlJ10gJiYgd2luZG93WydkZXZpY2UnXVsncGxhdGZvcm0nXSA9PSAnaU9TJykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgZ2V0QW5kcm9pZFZlcnNpb24oKSB7XG4gICAgaWYgKHRoaXMuaXNBbmRyb2lkKCkpIHtcbiAgICAgIHJldHVybiB3aW5kb3dbJ2RldmljZSddWyd2ZXJzaW9uJ107XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgZ2V0QXV0aFVybCgpIHtcbiAgICAvLyB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLmdldFZhbCgncHJvcGVydGllcycpO1xuICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuYmFzZVVybCArIHRoaXMucHJvcGVydGllcy50ZW5hbnROYW1lICsgJy9hdXRoLyc7XG4gIH1cbiAgcHVibGljIGdldFRlbmFudFVybCgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmJhc2VVcmwgKyB0aGlzLnByb3BlcnRpZXMudGVuYW50TmFtZSArICcvJztcbiAgfVxuXG4gIHB1YmxpYyBnZXRBcHBVcmwoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5iYXNlVXJsICsgdGhpcy5wcm9wZXJ0aWVzLnRlbmFudE5hbWUgKyAnL3Byb3h5LycgKyB0aGlzLnByb3BlcnRpZXMuYXBwTmFtZSArICcvJztcbiAgfVxuXG4gIHB1YmxpYyBnZXRQcm94eVVybCgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmJhc2VVcmwgKyB0aGlzLnByb3BlcnRpZXMudGVuYW50TmFtZSArICcvcHJveHkvJztcbiAgfVxuXG4gIHB1YmxpYyBnZXREYXRhTW9kZWxVcmwoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5iYXNlVXJsICsgdGhpcy5wcm9wZXJ0aWVzLnRlbmFudE5hbWUgKyAnL2RhdGFtb2RlbC8nICsgdGhpcy5wcm9wZXJ0aWVzLmFwcERhdGFTb3VyY2UgKyAnLycgKyB0aGlzLnByb3BlcnRpZXMuYXBwTmFtZSArICcvJztcbiAgfVxuXG4gIHB1YmxpYyBnZXRGaWxlSU9VcmwoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5iYXNlVXJsICsgdGhpcy5wcm9wZXJ0aWVzLnRlbmFudE5hbWUgKyAnL2ZpbGVpby8nICtcbiAgICAgIHRoaXMucHJvcGVydGllcy5hcHBEYXRhU291cmNlICsgJy8nICsgdGhpcy5wcm9wZXJ0aWVzLmFwcE5hbWUgKyAnLyc7XG4gIH1cblxuICBwdWJsaWMgZ2V0UGxhdGZvcm1EZXRhaWxzKHR5cGUpIHtcbiAgICBjb25zdCBwRGV0YWlscyA9IHtcbiAgICAgIHBsYXRmb3JtOiBwbGF0Zm9ybS5vcy5mYW1pbHksXG4gICAgICBwbGF0Zm9ybVZlcnNpb246IHBsYXRmb3JtLm9zLnZlcnNpb24sXG4gICAgfTtcbiAgICBpZiAodHlwZSA9PT0gJ2Jyb3dzZXInKSB7XG4gICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwRGV0YWlscywge1xuICAgICAgICB0eXBlOiAnYnJvd3NlcicsXG4gICAgICAgIGJyb3dzZXI6IHBsYXRmb3JtLm5hbWUsXG4gICAgICAgIGJyb3dzZXJWZXJzaW9uOiBwbGF0Zm9ybS52ZXJzaW9uLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnbW9iaWxlJyB8fCB0eXBlID09PSAnY29yZG92YV9icm93c2VyJykge1xuICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24ocERldGFpbHMsIHtcbiAgICAgICAgdHlwZTogJ21vYmlsZScsXG4gICAgICAgIG1vZGVsOiB3aW5kb3dbJ2RldmljZSddLm1vZGVsLFxuICAgICAgICBtYW51ZmFjdHVyZXI6IHdpbmRvd1snZGV2aWNlJ10ubWFudWZhY3R1cmVyLFxuICAgICAgICBpc1ZpcnR1YWw6IHdpbmRvd1snZGV2aWNlJ10uaXNWaXJ0dWFsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==